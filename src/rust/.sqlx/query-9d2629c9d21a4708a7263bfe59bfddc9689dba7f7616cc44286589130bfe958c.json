{
  "db_name": "PostgreSQL",
  "query": "INSERT INTO aggregator.fees\nWITH fees AS (\n  SELECT\n    sum(taker_quote_fees_paid) AS fees,\n    date_trunc('hour', \"time\") as \"time\",\n    market_id\n  FROM\n    fill_events f\n  WHERE ((SELECT * FROM aggregator.fees_last_indexed_txn) IS NULL OR f.txn_version > (SELECT * FROM aggregator.fees_last_indexed_txn))\n  AND emit_address = maker_address\n  GROUP BY\n    market_id,\n    date_trunc('hour', \"time\")\n)\nSELECT\n  \"time\",\n  market_id,\n  fees\nFROM\n  fees\nORDER BY\n  \"time\"\nON CONFLICT ON CONSTRAINT fees_pkey DO UPDATE SET\n  amount = fees.amount + EXCLUDED.amount;\n",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": []
    },
    "nullable": []
  },
  "hash": "9d2629c9d21a4708a7263bfe59bfddc9689dba7f7616cc44286589130bfe958c"
}
