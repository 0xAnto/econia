{
  "db_name": "PostgreSQL",
  "query": "INSERT INTO aggregator.prices\nSELECT\n    market_id,\n    date_trunc('minute', \"time\"),\n    AVG(price),\n    SUM(size)\nFROM fill_events\nWHERE emit_address = maker_address\nAND txn_version > COALESCE((SELECT * FROM aggregator.prices_last_indexed_txn), 0)\nGROUP BY date_trunc('minute', \"time\"), market_id\nORDER BY date_trunc('minute', \"time\"), market_id\nON CONFLICT ON CONSTRAINT prices_pkey DO UPDATE SET\nprice = (EXCLUDED.price * EXCLUDED.weight + prices.price * prices.weight) / (EXCLUDED.weight + EXCLUDED.weight);\n",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": []
    },
    "nullable": []
  },
  "hash": "dcee3bc57e458b02fc11c4cc70d080c952117819d32945093e11cde66c49d179"
}
